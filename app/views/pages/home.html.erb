<div class="home-container">
  <div class="home-video">
    <div class="player" data-toggle="modal" data-target="#myModal">
      <%= video_tag "James-Wild-Home.mp4", class: "player__video viewer", autoplay: true, muted: true%>
      <div class="video-logo-holder">
        <div class="logo-and-play">
          <%= image_tag "video-logo.png", class:"video-logo" %>
          <button class="player_button toggle" title="Toggle Play">►</button>
        </div>
      </div>
    </div>
  </div>
  <div class="main-text">
    <p class="text-center main-content">James Wild Sculpture’s inception in 2009 came from James’ affinity with the natural world and his powerful desire to want to protect and preserve for future generations.</p>
    <p class="text-center main-content">Raising awareness, consideration and love for our natural treasures will be the immortal motivation driving his work.</p>
  </div>
  <div class="home-latest-work">
    <h4 class="text-center subheader">LATEST WORK</h4>
    <div class="vertical-margin">
      <div class="container">
        <div class="row">
          <% @projects.each do |project| %>
            <div class="col-xs-12 col-sm-6 col-md-4">
              <%= link_to project_path(project) do %>
                <div class="latest-work-card" style="background-image: url(<%= project.photos.empty? ? image_path("bronze_background.png") : cl_image_path(project.photos.first.url.url, quality: "auto:low")%>);">
                  <div class="linear-gradient-hover">
                    <p class="latest-work-type">
                      <%= project.bronze? ? "BRONZE" : "SCRAP" %>
                    </p>
                    <p class="latest-work-title">
                      <%= project.name %>
                    </p>
                  </div>
                </div>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-video">
    <div class="modal_player">
      <%= video_tag "James-Wild-Home.mp4", class: "modal_player_video modal_viewer"%>
      <button class="player_button toggle" title="Toggle Play">►</button>
    </div>
  </div>
</div>

<script>
  const player = document.querySelector('.modal_player');
  const video = player.querySelector('.modal_viewer');
  const toggle = player.querySelector('.toggle');

  function togglePlay() {
    if (video.paused) {
      video.play()
    } else {
      video.pause()
    }
  }

  function updateButton() {
    const icon = this.paused ? '►' : '❚❚';
    console.log(icon);
    toggle.textContent = icon;
  }

  video.addEventListener('click', togglePlay);
  video.addEventListener('play', updateButton);
  video.addEventListener('pause', updateButton);
  toggle.addEventListener('click', togglePlay);
</script>
